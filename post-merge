nano post-merge
#!/bin/bash

# Ton prÃ©cieux sÃ©same
OPENAI_KEY="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"

# Fichier .env Ã  protÃ©ger
ENV_FILE="$(git rev-parse --show-toplevel)/.env"

echo "ğŸ” Post-merge : Mise Ã  jour de la clÃ© OpenAI..."

# Injecte ou Ã©crase le .env
echo "OPENAI_API_KEY=$OPENAI_KEY" > "$ENV_FILE"

# Assure quâ€™il est ignorÃ© par Git
GITIGNORE_FILE="$(git rev-parse --show-toplevel)/.gitignore"
if [ ! -f "$GITIGNORE_FILE" ] || ! grep -qxF ".env" "$GITIGNORE_FILE"; then
  echo ".env" >> "$GITIGNORE_FILE"
fi

echo "âœ… ClÃ© injectÃ©e dans $ENV_FILE"
#!/bin/bash

# ğŸ” ClÃ© API OpenAI
OPENAI_KEY="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"

# ğŸ“œ Fichiers
ENV_FILE="$(git rev-parse --show-toplevel)/.env"
GITIGNORE_FILE="$(git rev-parse --show-toplevel)/.gitignore"

# ğŸ”§ Injecte la clÃ©
echo "OPENAI_API_KEY=$OPENAI_KEY" > "$ENV_FILE"

if [ ! -f "$GITIGNORE_FILE" ] || ! grep -qxF ".env" "$GITIGNORE_FILE"; then
  echo ".env" >> "$GITIGNORE_FILE"
fi

# ğŸ”” Notification Discord
WEBHOOK_URL="https://discord.com/api/webhooks/TON_WEBHOOK_ID"

PAYLOAD="{
  \"content\": \"âœ… ClÃ© OpenAI injectÃ©e avec succÃ¨s dans \`$(basename $(git rev-parse --show-toplevel))\`.\"
}"

curl -H "Content-Type: application/json" \
     -X POST \
     -d "$PAYLOAD" \
     "$WEBHOOK_URL"
TO_EMAIL="ton.email@domaine.com"
SUBJECT="ğŸ§  ClÃ© OpenAI injectÃ©e"
BODY="La clÃ© OpenAI a Ã©tÃ© injectÃ©e avec succÃ¨s dans le projet: $(basename $(git rev-parse --show-toplevel))."

echo "$BODY" | mail -s "$SUBJECT" "$TO_EMAIL"
defaults
auth           on
tls            on
tls_trust_file /etc/ssl/certs/ca-certificates.crt
logfile        ~/.msmtp.log

account gmail
host smtp.gmail.com
port 587
from ton.email@gmail.com
user ton.email@gmail.com
password TON_MOT_DE_PASSE_APPLI

account default : gmail
#!/bin/bash

# Chemin vers le fichier .env
ENV_FILE="$(git rev-parse --show-toplevel)/.env"

# ğŸ” Supprime la ligne contenant OPENAI_API_KEY
if [ -f "$ENV_FILE" ]; then
  grep -v "^OPENAI_API_KEY=" "$ENV_FILE" > "$ENV_FILE.tmp" && mv "$ENV_FILE.tmp" "$ENV_FILE"
fi

# ğŸ§  Log facultatif
echo "ğŸ” ClÃ© OpenAI retirÃ©e de .env avant push"
