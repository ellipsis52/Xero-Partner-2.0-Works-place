const sendMessage = async () => {
  setState({ ...state, loading: true, log: "", reply: "", status: null });

  try {
    const controller = new AbortController();
    const timeout = setTimeout(() => controller.abort(), 10000); // Timeout de 10s

    console.log("ğŸ“¤ Envoi du message Ã  IPRANET:", state.message);

    const res = await axios.post(
      "https://app.netmanagement.online/api/chat",
      { message: state.message },
      { signal: controller.signal }
    );
    clearTimeout(timeout);

    console.log("ğŸŒ RÃ©ponse complÃ¨te du serveur :", JSON.stringify(res, null, 2));
    console.log("ğŸ“© RÃ©ponse d'IPRANET :", res?.data?.reply ?? "âš ï¸ Aucune rÃ©ponse trouvÃ©e.");

    if (res?.data?.reply && typeof res.data.reply === "string") {
      setState({
        ...state,
        reply: res.data.reply,
        log: `âœ… SuccÃ¨s: ${JSON.stringify(res.data)}`,
        status: "success",
      });
    } else {
      setState({
        ...state,
        reply: "âŒ IPRANET n'a pas compris la rÃ©ponse du serveur.",
        log: `âš ï¸ RÃ©ponse inattendue du serveur.`,
        status: "warning",
      });
    }
  } catch (error) {
    console.error("ğŸ”¥ Erreur dÃ©tectÃ©e :", error); // <-- LOG COMPLET DE L'ERREUR
    handleError(error);
  } finally {
    setState((prev) => ({ ...prev, loading: false }));
  }
};
