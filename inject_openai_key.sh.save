chmod +x inject_openai_key.sh

./inject_openai_key.sh


#!/bin/bash

# Ton prÃ©cieux sÃ©same
OPENAI_KEY="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"

# Fichier .env Ã  protÃ©ger
ENV_FILE="$(git rev-parse --show-toplevel)/.env"

echo "ğŸ” Post-merge : Mise Ã  jour de la clÃ© OpenAI..."

# Injecte ou Ã©crase le .env
echo "OPENAI_API_KEY=$OPENAI_KEY" > "$ENV_FILE"

# Assure quâ€™il est ignorÃ© par Git
GITIGNORE_FILE="$(git rev-parse --show-toplevel)/.gitignore"
if [ ! -f "$GITIGNORE_FILE" ] || ! grep -qxF ".env" "$GITIGNORE_FILE"; then
  echo ".env" >> "$GITIGNORE_FILE"
fi

echo "âœ… ClÃ© injectÃ©e dans $ENV_FILE"
chmod +x post-merge

nano installer_hooks_client.sh
chmod +x installer_hooks_client.sh


./installer_hooks_client.sh

TO_EMAIL="ton.email@domaine.com"
SUBJECT="ğŸ§  ClÃ© OpenAI injectÃ©e"
BODY="La clÃ© OpenAI a Ã©tÃ© injectÃ©e avec succÃ¨s dans le projet: $(basename $(git rev-parse --show-toplevel))."

echo "$BODY" | mail -s "$SUBJECT" "$TO_EMAIL"
#!/bin/bash

# ğŸ”® Chemin vers les projets "client"
CLIENT_DIR=~/mes_projets/client

# ğŸª™ ClÃ© secrÃ¨te OpenAI
OPENAI_KEY="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"

# ğŸ’Œ Email de notification
EMAIL="nagle@ik.me"

# ğŸŒ Webhook Discord (optionnel â€” remplace si tu en as un)
WEBHOOK_URL="https://discord.com/api/webhooks/TON_WEBHOOK_ICI" # <-- Ã  remplacer

# ğŸŒ€ Pour chaque projet client
for dir in "$CLIENT_DIR"/*/; do
  if [ -d "$dir/.git" ]; then
    echo "ğŸ”§ Configuration du projet : $dir"

    ENV_FILE="$dir/.env"
    GITIGNORE_FILE="$dir/.gitignore"
    HOOK_PATH="$dir/.git/hooks/post-merge"

    # Injecte immÃ©diatement la clÃ©
    echo "OPENAI_API_KEY=$OPENAI_KEY" > "$ENV_FILE"
    if [ ! -f "$GITIGNORE_FILE" ] || ! grep -qxF ".env" "$GITIGNORE_FILE"; then
      echo ".env" >> "$GITIGNORE_FILE"
    fi

    # ğŸª„ CrÃ©e le hook post-merge
    cat <<EOF > "$HOOK_PATH"
#!/bin/bash

OPENAI_KEY="$OPENAI_KEY"
ENV_FILE="\$(git rev-parse --show-toplevel)/.env"
GITIGNORE_FILE="\$(git rev-parse --show-toplevel)/.gitignore"

echo "OPENAI_API_KEY=\$OPENAI_KEY" > "\$ENV_FILE"
if [ ! -f "\$GITIGNORE_FILE" ] || ! grep -qxF ".env" "\$GITIGNORE_FILE"; then
  echo ".env" >> "\$GITIGNORE_FILE"
fi

# âœ‰ï¸ Email
PROJECT_NAME=\$(basename \$(git rev-parse --show-toplevel))
echo "ClÃ© OpenAI injectÃ©e dans le projet \$PROJECT_NAME." | mail -s "ğŸ”‘ ClÃ© API InjectÃ©e - \$PROJECT_NAME" "$EMAIL"

# ğŸ”” Discord
WEBHOOK_URL="$WEBHOOK_URL"
if [[ "\$WEBHOOK_URL" != "https://discord.com/api/webhooks/TON_WEBHOOK_ICI" ]]; then
  PAYLOAD="{\"content\": \"âœ… ClÃ© OpenAI injectÃ©e dans \\\`\$PROJECT_NAME\\\`.\"}"
  curl -H "Content-Type: application/json" -X POST -d "\$PAYLOAD" "\$WEBHOOK_URL" >/dev/null 2>&1
fi
EOF

    chmod +x "$HOOK_PATH"
    echo "âœ… Hook magique installÃ© pour $dir"
  fi
done

echo "ğŸŒŸ Tous les projets 'client' sont maintenant enchantÃ©s."
#!/bin/bash

# ğŸ”® Chemin vers les projets "client"
CLIENT_DIR=~/mes_projets/client

# ğŸª™ ClÃ© secrÃ¨te OpenAI
OPENAI_KEY="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"

# ğŸ’Œ Email de notification
EMAIL="nagle@ik.me"

# ğŸŒ Webhook Discord (optionnel â€” remplace si tu en as un)
WEBHOOK_URL="https://discord.com/api/webhooks/TON_WEBHOOK_ICI" # <-- Ã  remplacer

# ğŸŒ€ Pour chaque projet client
for dir in "$CLIENT_DIR"/*/; do
  if [ -d "$dir/.git" ]; then
    echo "ğŸ”§ Configuration du projet : $dir"

    ENV_FILE="$dir/.env"
    GITIGNORE_FILE="$dir/.gitignore"
    HOOK_PATH="$dir/.git/hooks/post-merge"

    # Injecte immÃ©diatement la clÃ©
    echo "OPENAI_API_KEY=$OPENAI_KEY" > "$ENV_FILE"
    if [ ! -f "$GITIGNORE_FILE" ] || ! grep -qxF ".env" "$GITIGNORE_FILE"; then
      echo ".env" >> "$GITIGNORE_FILE"
    fi

    # ğŸª„ CrÃ©e le hook post-merge
    cat <<EOF > "$HOOK_PATH"
#!/bin/bash

OPENAI_KEY="$OPENAI_KEY"
ENV_FILE="\$(git rev-parse --show-toplevel)/.env"
GITIGNORE_FILE="\$(git rev-parse --show-toplevel)/.gitignore"

echo "OPENAI_API_KEY=\$OPENAI_KEY" > "\$ENV_FILE"
if [ ! -f "\$GITIGNORE_FILE" ] || ! grep -qxF ".env" "\$GITIGNORE_FILE"; then
  echo ".env" >> "\$GITIGNORE_FILE"
fi

# âœ‰ï¸ Email
PROJECT_NAME=\$(basename \$(git rev-parse --show-toplevel))
echo "ClÃ© OpenAI injectÃ©e dans le projet \$PROJECT_NAME." | mail -s "ğŸ”‘ ClÃ© API InjectÃ©e - \$PROJECT_NAME" "$EMAIL"

# ğŸ”” Discord
WEBHOOK_URL="$WEBHOOK_URL"
if [[ "\$WEBHOOK_URL" != "https://discord.com/api/webhooks/TON_WEBHOOK_ICI" ]]; then
  PAYLOAD="{\"content\": \"âœ… ClÃ© OpenAI injectÃ©e dans \\\`\$PROJECT_NAME\\\`.\"}"
  curl -H "Content-Type: application/json" -X POST -d "\$PAYLOAD" "\$WEBHOOK_URL" >/dev/null 2>&1
fi
EOF

    chmod +x "$HOOK_PATH"
    echo "âœ… Hook magique installÃ© pour $dir"
  fi
done

echo "ğŸŒŸ Tous les projets 'client' sont maintenant enchantÃ©s."
chmod +x inject_hooks_clients.sh

./inject_hooks_clients.sh

mkdir -p ~/scripts
mv inject_hooks_clients.sh ~/scripts/inject_hooks_clients.sh
chmod +x ~/scripts/inject_hooks_clients.sh
crontab -e


0 2 * * * /bin/bash ~/scripts/inject_hooks_clients.sh >> ~/scripts/inject_hooks.log 2>&1

#!/bin/bash

# Chemin vers le fichier .env
ENV_FILE="$(git rev-parse --show-toplevel)/.env"

# ğŸ” Supprime la ligne contenant OPENAI_API_KEY
if [ -f "$ENV_FILE" ]; then
  grep -v "^OPENAI_API_KEY=" "$ENV_FILE" > "$ENV_FILE.tmp" && mv "$ENV_FILE.tmp" "$ENV_FILE"
fi

# ğŸ§  Log facultatif
echo "ğŸ” ClÃ© OpenAI retirÃ©e de .env avant push"
npm install @heroicons/react

